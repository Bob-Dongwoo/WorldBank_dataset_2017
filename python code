#import necessary modules into python
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

#import the raw data file
file = "WDIW Dataset.xlsx"
raw = pd.read_excel(file)

# changing long unnecessary column names
new_columns = ['Country Code', 'Country Name', 'Hult Region', 'Cool Name',
       'electricity total', 'electricity rural', 'electricity urban',
       'fertility 15-19', 'age dependency total', 'age dependency old',
       'age dependency young', 'agriculture %GDP', 'military % of work pop',
       'birth rate', 'birth skilled', 'death rate', 'PhD', 'bachelor',
       'master', 'lower secondary', 'post secondary', 'primary',
       'short-cycle tertiary', 'upper secondary', 'employment agriculture',
       'employment industry', 'employment service', 'fertility rate', 'GDP',
       'GDP growth', 'GINI index', 'education expenditure %',
       'income share fourth quantile', 'income share first quantile',
       'income share fifth quantile', 'income share second quantile',
       'income share third quantile', 'industry % GDP', 'life expectancy',
       'literacy adult', 'literacy young', 'trade % GDP', 'military % GDP',
       'mobile per 100', 'health poverty below $3.10', 'population 0-14',
       'population 15-64', 'population 65 above', 'population density',
       'population growth', 'pop largest city (% of urban pop)',
       'pop slums (% of urban pop)', 'pop female', 'pop male', 'pop total',
       'poverty $1.90 a day', 'poverty $3.20 a day', 'poverty ratio',
       'HIV rate', 'undernourishment %', 'underweight children under 5',
       'rural pop', 'service % GDP', 'surface area', 'tax revenue % GDP',
       'urban pop', 'urban pop growth']

# changed the name of the columns into shorter form
raw.columns = new_columns

# adding additional columns into the data: GDP per capita
raw['GDP per capita'] = raw['GDP'] / raw['pop total']

# added social progress index
file2 = 'SPI.xlsx'
spi = pd.read_excel(file2)

# in the SPI dataset the country name contains unnecessary spaces 
country_name = []
for country in spi['Country Name'].values:
    country_name.append(country.rstrip()) # getting rid of unnecessary spaces

# replacing the values with the cleaned country name
spi['Country Name'] = country_name

# Merging the SPI data to the raw data on the country name column
merge = pd.merge(raw, spi, how = 'left', on = 'Country Name')

#import the metadata file
file3 = 'WDI_Metadata.xlsx'
metadata = pd.ExcelFile(file3)

# metadata file contains multiple excel sheet
country_data = metadata.parse('Country - Metadata') #parsing the necessary sheet

# selecting the necessary columns the region and income group of countries
country_income_region = country_data[['Country Code', 'Income Group', 'Region']]

# merging the two dataframes on the country code since merge(raw) is the main left join is used
merge2 = pd.merge(merge, country_income_region, on = 'Country Code', how = 'left')

